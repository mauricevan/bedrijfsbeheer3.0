# Boekhouding, Offertes & Facturen

ğŸ†• **VOLLEDIG UITGEBREID + WERKORDER INTEGRATIE V4.0 + CLONE FUNCTIE V4.6**

## Overzicht

Volledig geÃ¯ntegreerd boekhoudsysteem met offertes, facturen, grootboekrekeningen, BTW-overzicht, journaalposten en digitaal dossier. MKB-ready en NL-compliant.

---

## Transacties Tab

- âœ… **Overzicht transacties** (inkomsten/uitgaven)
- âœ… **Filter op type** (alle/inkomsten/uitgaven)
- âœ… **KPI cards** (totale inkomsten, uitgaven, netto winst)
- âœ… **Transactie historie** met datum

## Offertes Tab

ğŸ†• **UITGEBREID MET OVERZICHT MODALS V4.7 + EMAIL INTEGRATIE V5.8**

### Basis Offerte Beheer

- âœ… **Offertes maken en beheren** met meerdere items
- âœ… **Items uit voorraad selecteren** - Dropdown met alle voorraad items inclusief prijzen
- âœ… **Custom items toevoegen** - Voor items die niet in voorraad staan
- âœ… **Werkuren toevoegen (optioneel)** - Uren, uurtarief en automatische berekening
- âœ… **BTW berekeningen** - Instelbaar BTW percentage (standaard 21%)

### Prijsweergave

- âœ… **Duidelijke prijsweergave:**
  - Subtotaal (excl. BTW)
  - BTW bedrag
  - Totaal (incl. BTW)
- âœ… **Automatische berekeningen** - Real-time updates bij aanpassingen

### Status & Beheer

- âœ… **Status tracking**: draft â†’ sent â†’ approved/rejected
- âœ… **Klant koppeling**
- âœ… **Geldig tot datum**
- âœ… **Items tonen voorraad koppeling** (indien van toepassing)
- âœ… **Notities per offerte**
- âœ… **Status updaten** (admin)

### Conversie Functies

- âœ… **Omzetten naar factuur** - Geaccepteerde offertes direct converteren
- ğŸ†• **Omzetten naar werkorder** - Geaccepteerde offertes worden werkorder met alle details
- ğŸ†• **Werkorder status tracking** - Zie de status van gekoppelde werkorder in offerte
- ğŸ†• **Live synchronisatie** - Wijzigingen in offerte worden doorgevoerd naar werkorder
- ğŸ†• **Voltooiing indicator** - Visueel zien wanneer werkorder voltooid is

### Clone Functionaliteit

- ğŸ†• **Offerte clonen** - Dupliceer bestaande offerte met automatisch nieuw ID en datum ğŸ”„ **V4.6**
- ğŸ†• **Aanpasbaar tijdens clonen** - Wijzig klant, items, prijzen tijdens het clonen ğŸ”„ **V4.6**
- ğŸ†• **Automatische kloon bij acceptatie** (V5.6) - Checkbox in acceptatie modal om offerte automatisch te klonen voor volgende periode (+30 dagen)

### Statistieken & Overzichten

- ğŸ†• **Offerte statistieken** - Totaal geoffreerd, geaccepteerd, verzonden, verlopen (klikbaar)
- ğŸ†• **Overzicht Modals** - Bij klikken op statistiek badges:
  - Filter op klantnaam, datum, bedrag
  - Zie alle offertes in gefilterde lijst
  - âœï¸ Bewerken knop bij elke offerte
  - ğŸ“‹ Clonen knop bij elke offerte
  - ğŸ“¤ Naar Werkorder knop (alleen voor approved/sent zonder werkorder)

### Email Integratie (V5.8)

- ğŸ†• **Email integratie** - Sleep .eml bestanden naar offertes tab:
  - Automatische offerte creatie vanuit emails
  - Detecteert items, prijzen en werkuren in email tekst
  - Klant selectie of creatie vanuit email adres
  - Preview modal voor verificatie voordat offerte wordt aangemaakt

## Facturen Tab

ğŸ†• **NIEUW TOEGEVOEGD + WERKORDER INTEGRATIE V4.0 + OVERZICHT MODAL V4.7**

### Statistieken Dashboard

- âœ… **4 Statistiek Cards:**
  - **Totaal Gefactureerd** (â‚¬ alle facturen) - Klikbaar â†’ Overzicht modal
  - **Betaald** (â‚¬ en aantal) - Klikbaar â†’ Overzicht modal
  - **Uitstaand** (â‚¬ en aantal verzonden/verlopen) - Klikbaar â†’ Overzicht modal
  - **Verlopen** (â‚¬ en aantal met rode alert) - Klikbaar â†’ Overzicht modal

### Overzicht Modals

- ğŸ†• **Overzicht Modals** - Bij klikken op statistiek cards:
  - Filter op klantnaam, datum, bedrag
  - Zie alle facturen in gefilterde lijst
  - âœï¸ Bewerken knop bij elke factuur
  - ğŸ“‹ Clonen knop bij elke factuur
  - ğŸ“¤ Naar Werkorder knop (alleen voor sent/draft zonder werkorder)

### Factuur Aanmaken

- âœ… **Automatische factuurnummer generatie** (2025-001, 2025-002, etc.)
- âœ… **Handmatig facturen aanmaken:**
  - Items uit voorraad selecteren
  - Custom items toevoegen
  - Werkuren optioneel toevoegen
  - BTW berekening
  - Factuurdatum en vervaldatum
  - Betalingsvoorwaarden (14/30 dagen)

### Offerte Conversie

- âœ… **Offertes omzetten naar facturen:**
  - Paarse knop "ğŸ§¾ Omzetten naar Factuur" bij geaccepteerde offertes
  - Automatische conversie van alle items en werkuren
  - Link naar originele offerte behouden
  - Betalingstermijn automatisch berekenen

### Status Beheer

- âœ… **Status beheer:**
  - Draft â†’ Verzenden â†’ Betaald
  - Overdue status voor verlopen facturen
  - Annuleren functionaliteit

### Betalings Tracking

- âœ… **Betalings tracking:**
  - Factuurdatum (issue date)
  - Vervaldatum (due date)
  - Betaaldatum (paid date) - automatisch bij markeren als betaald

### Visuele Indicatoren

- âœ… **Visuele indicatoren:**
  - Rode border voor verlopen facturen
  - Groene status voor betaalde facturen
  - Blauwe link naar originele offerte
  - Status badges met kleuren

### Factuur Details

- âœ… **Factuur details:**
  - Items met voorraad koppeling
  - Werkuren indien van toepassing
  - Subtotaal, BTW, Totaal duidelijk weergegeven
  - Notities per factuur
  - Betalingsvoorwaarden zichtbaar

### Werkorder Integratie

- ğŸ†• **Omzetten naar werkorder** - Verzonden facturen worden werkorder
- ğŸ†• **Werkorder status tracking** - Zie de status van gekoppelde werkorder in factuur
- ğŸ†• **Live synchronisatie** - Wijzigingen in factuur worden doorgevoerd naar werkorder
- ğŸ†• **Voltooiing indicator** - Visueel zien wanneer werkorder voltooid is
- ğŸ†• **Tussentijdse aanpassing** - Facturen en werkorders blijven gesynchroniseerd
- ğŸ†• **Automatische factuur generatie** - Voltooide werkorders worden automatisch omgezet naar facturen

### Herinneringen & Automatisering

- ğŸ†• **Automatische herinneringsplanning** (V5.6) - Bij verzenden worden herinneringsdatums automatisch berekend (+7 en +14 dagen na vervaldatum)
- ğŸ†• **Herinnering nu sturen** (V5.6) - Handmatige trigger voor directe herinnering met template tekst
- ğŸ†• **Betaalde facturen verbergen** (V5.6) - Betaalde facturen zijn alleen zichtbaar in Boekhouding & Dossier, niet in Facturen-tab

### Toekomstige Features

- ğŸ”„ **Digitale goedkeuring** door klant
- ğŸ”„ **PDF generatie**
- ğŸ”„ **Email verzending**
- ğŸ”„ **Automatische email herinneringen** (Fase 2 - toekomstig)
- ğŸ”„ **Uren, materialen en kilometers factureren**
- ğŸ”„ **Facturen splitsen** (materiaal + arbeid)

---

## Werkorder Integratie Features (V4.0)

### 1. Offerte/Factuur â†’ Werkorder Conversie

- ğŸ†• **Knop "ğŸ“‹ Maak Werkorder"** bij geaccepteerde offertes
- ğŸ†• **Knop "ğŸ“‹ Maak Werkorder"** bij verzonden facturen
- ğŸ†• **Automatische werkorder aanmaken** met:
  - Titel van offerte/factuur
  - Klant automatisch gekoppeld
  - Alle items als benodigde materialen
  - Werkuren als geschatte tijd
  - Status: To Do (klaar om te starten)
  - Referentie naar originele offerte/factuur

### 2. Werkorder Status Weergave

- ğŸ†• **Status Badge** in offerte/factuur card:
  - ğŸ”µ "Werkorder: To Do" (blauw)
  - ğŸŸ¡ "Werkorder: In Wacht" (geel)
  - ğŸŸ¢ "Werkorder: In Uitvoering" (groen)
  - âœ… "Werkorder: Voltooid" (groen met vinkje)
- ğŸ†• **Link naar werkorder** - Klik om direct naar workboard te gaan
- ğŸ†• **Real-time updates** - Status wordt automatisch bijgewerkt

### 3. Tussentijdse Aanpassing & Synchronisatie

- ğŸ†• **"âœï¸ Bewerk & Update Werkorder" knop** in offertes/facturen
- ğŸ†• **Bidirectionele synchronisatie:**
  - Wijzig items in offerte â†’ Materialen in werkorder worden bijgewerkt
  - Wijzig werkuren in offerte â†’ Geschatte tijd in werkorder wordt bijgewerkt
  - Voeg materiaal toe/verwijder â†’ Werkorder wordt automatisch aangepast
- ğŸ†• **Waarschuwingen bij conflicten:**
  - Als werkorder al gestart is, waarschuwing tonen
  - Als werkorder voltooid is, blokkeer aanpassingen (behalve notities)
- ğŸ†• **Audit trail** - Alle wijzigingen worden gelogd

### 4. Voltooiings Workflow

- ğŸ†• **Groen Voltooiings Badge** bij afgeronde werkorders
- ğŸ†• **Automatische factuur update** - Betaal knop wordt actief
- ğŸ†• **Gewerkte uren tonen** - Daadwerkelijke vs. geschatte uren
- ğŸ†• **Materiaalgebruik overzicht** - Werkelijk vs. gepland

### 5. Visuele Indicatoren

- ğŸ†• **Groene border** rond offerte/factuur met voltooide werkorder
- ğŸ†• **Status icon** in header (ğŸ”§ = in uitvoering, âœ… = voltooid)
- ğŸ†• **Progress indicator** - % voltooid in werkorder sectie
- ğŸ†• **Tijdlijn weergave** - Van offerte â†’ werkorder â†’ voltooiing

---

## Module 5.5: Boekhouding & Dossier

ğŸ†• **NIEUWE MODULE - MKB-READY, NL-COMPLIANT**
ğŸ†• **V5.4: KASSA VERKOPEN TAB & KLIKBARE FACTUREN**

### Overzicht

Volledig Digitaal Boekhouddossier - Alles wat een boekhouder nodig heeft.

#### Doel

- âœ… **Geen fouten in BTW-aangifte**
- âœ… **Volledig digitaal dossier** per klant/leverancier
- âœ… **Direct klaar voor controle** (Belastingdienst, accountant)
- âœ… **Geen handmatig overtypen** uit facturen/pakbonnen

---

### 1. Grootboekrekeningen (Standaard MKB-Set)

- âœ… **10 Standaard rekeningen** ingesteld (niet aanpasbaar):
  - 1300 â€“ Debiteuren (openstaande facturen)
  - 1400 â€“ Voorraad
  - 4000 â€“ Inkoop grondstoffen
  - 4400 â€“ Inkoop diensten
  - 8000 â€“ Omzet goederen (21% BTW)
  - 8010 â€“ Omzet diensten (9% BTW)
  - 8020 â€“ Omzet vrijgesteld (0%)
  - 1600 â€“ Crediteuren (openstaande inkoop)
  - 2200 â€“ BTW hoog (21%)
  - 2210 â€“ BTW laag (9%)
- âœ… **Export functionaliteit** - Exporteer grootboek naar CSV (voor Exact, Twinfield, etc.)
- âœ… **Tabel overzicht** - Alle rekeningen met type, categorie en omschrijving

---

### 2. Factuur & Pakbon Archief (Digitaal Dossier)

ğŸ†• **V5.4: KLIKBARE FACTUREN + FINANCIEEL OVERZICHT**

#### Automatisch Archief

- âœ… **Automatisch archief** - Elke factuur wordt automatisch toegevoegd aan archief
- âœ… **Twee weergaven:**
  - ğŸ“„ **Facturen Lijst** - Overzicht van alle facturen als cards
  - ğŸ“Š **Financieel Overzicht** - Excel-achtige tabel met gedetailleerde item breakdown

#### Per Document Informatie

- âœ… **Factuurnummer** (auto: 2025-001)
- âœ… **Datum uitgifte / vervaldatum**
- âœ… **Klant / Leverancier**
- âœ… **Totaal excl. / BTW / incl.**
- âœ… **Status**: Betaald / Openstaand / Herinnering / Vervallen
- âœ… **Koppeling aan**: Werkorder / Pakbon / Kassa

#### Zoeken & Filteren (Lijst weergave)

- âœ… **Zoek** op nummer, klant, datum
- âœ… **Filter** op status (Openstaand / Betaald / Vervallen)

#### Financieel Overzicht Features

- ğŸ†• **Periode filter** - Vandaag, Deze Week, Dit Kwartaal, Dit Jaar, Alle Facturen, Aangepaste Periode
- ğŸ†• **Klantnaam filter** - Zoek op (deel van) klantnaam
- ğŸ†• **Summary cards (2 rijen):**
  - **Eerste rij**: Totaal Items, Totaal Aantal, Omzet (incl. BTW), BTW Totaal
  - **Tweede rij**: Betaald Omzet, Openstaand Omzet, Vervallen Omzet, Draft Omzet
- ğŸ†• **Excel-achtige tabel** met alle factuur items:
  - Datum, Factuur, Klant, Status, Product, Aantal, Prijs per stuk, BTW %, BTW bedrag, Totaal (incl. BTW)
  - Totaalrij onderaan
  - Sorteerbaar op datum (nieuwste eerst)
- ğŸ†• **CSV export** - Exporteer gefilterde data naar CSV
- ğŸ†• **Extra statistieken** - Unieke Facturen, Unieke Producten, Unieke Klanten

#### Klikbare Facturen & Detail Modal

- âœ… **Klikbare facturen** ğŸ†• - Klik op elke factuur om volledige details te zien
- âœ… **Detail modal (read-only)** ğŸ†• - Volledige factuurdetails in overzichtelijke modal:
  - Factuurnummer, status, klant, datums
  - Items tabel (omschrijving, aantal, prijs, totaal)
  - Werkuren tabel (indien aanwezig)
  - Totaaloverzicht (subtotaal, BTW, totaal)
  - Notities (indien aanwezig)

#### Clone Functionaliteit

- âœ… **Clone functionaliteit** ğŸ†• - Vanuit detail modal:
  - ğŸ“‹ **Klonen naar Factuur** - Maak nieuwe factuur met status 'draft'
  - ğŸ“„ **Klonen naar Offerte** - Maak nieuwe offerte met status 'draft'
  - Automatische nummering voor nieuwe facturen/offertes
  - Notitie: "Gekloond van factuur XXX"

#### Acties per Factuur

- âœ… **Acties per factuur:**
  - ğŸ“„ PDF download (placeholder)
  - ğŸ“§ Herinnering sturen (placeholder)
  - âœ“ Markeer als betaald (direct in archief)

#### Visuele Status Indicatoren

- âœ… **Visuele status indicatoren:**
  - Rode border voor verlopen facturen
  - Groene badge voor betaalde facturen
  - Gele badge voor openstaande facturen
  - Cursor pointer en hover-effecten voor duidelijkheid

---

### 3. Kassa Verkopen

ğŸ†• **V5.4: NIEUWE TAB VOOR KASSA TRANSACTIES**

- ğŸ†• **Aparte tab** - "ğŸ›’ Kassa Verkopen" in Boekhouding & Dossier module
- ğŸ†• **Automatische filtering** - Toont alle facturen via kassasysteem:
  - Herkend aan "Kassa verkoop" in notes
  - Of customerName "Particulier (Kassa)"
- ğŸ†• **Direct betaalde facturen** - Alle kassa verkopen hebben status 'paid'
- ğŸ†• **Betaalmethode weergave** - Toont betaalmethode (Contant, PIN, iDEAL, Creditcard)
- ğŸ†• **Groene styling** - Visuele indicatie dat deze direct betaald zijn
- ğŸ†• **Klikbaar** - Klik op elke kassa verkoop om details te zien
- ğŸ†• **Zelfde detail modal** - Gebruikt dezelfde read-only modal als Factuur Archief
- ğŸ†• **Clone functionaliteit** - Kan ook gekloond worden naar factuur of offerte

---

### 4. BTW-Overzicht (Aangifte-Ready)

- âœ… **Automatische berekening** per maand/kwartaal
- âœ… **Periode rapport met:**
  - Omzet 21% â†’ BTW af te dragen
  - Omzet 9% â†’ BTW af te dragen
  - Omzet 0% â†’ BTW (vrijgesteld)
  - Totaal af te dragen
  - Voorbelasting (inkoop) - placeholder
  - Te betalen (totaal)
- âœ… **Export knoppen:**
  - ğŸ“¥ Export XML (placeholder - voor Belastingdienst portaal)
  - ğŸ“„ Print PDF (beschikbaar)
- âœ… **Dynamische data** - Automatisch berekend uit facturen
- âœ… **Periode selectie** - Kies maand/kwartaal voor rapport

---

### 5. Klant- & Leveranciersdossiers

- âœ… **Alles op Ã©Ã©n plek** - Zoals een fysiek dossierkast
- âœ… **Per relatie informatie:**
  - Naam, adres, KvK, BTW-nummer
  - Openstaand saldo
  - Alle facturen (verkoop + inkoop)
  - Pakbonnen (placeholder)
  - Offertes / Werkorders (placeholder)
  - Notities ("Betaalt altijd laat", etc.)
  - Credit-limiet (voor B2B)
- âœ… **Tabbladen structuur:**
  - Facturen
  - Pakbonnen (placeholder)
  - Offertes (placeholder)
  - Notities (placeholder)
- âœ… **Zoekfunctionaliteit** - Zoek klant of leverancier

---

### 6. Transactieregistratie (Journaal)

#### Automatische Journaalposten

- âœ… **Volledig automatisch** - Elke factuur genereert journaalpost
- âœ… **Journaalstructuur:**
  - Journaalnummer (JRN-2025-001, etc.)
  - Datum en omschrijving
  - Referentie (factuurnummer)
  - Bron type (POS / Pakbon / Factuur / Inkoop / Handmatig)

#### Journaalregels (Debet/Credit)

- âœ… **Journaalregels:**
  - Debet: 1300 Debiteuren (totaal bedrag)
  - Credit: 8000/8010/8020 Omzet (excl. BTW)
  - Credit: 2200/2210 BTW (BTW bedrag)

#### Automatische Grootboek Toewijzing

- âœ… **Automatische grootboek toewijzing:**
  - BTW 21% â†’ Rekening 2200
  - BTW 9% â†’ Rekening 2210
  - Omzet goederen â†’ Rekening 8000
  - Omzet diensten â†’ Rekening 8010
  - Omzet vrijgesteld â†’ Rekening 8020

#### Beheer & Export

- âœ… **Handmatig toevoegen** - Knop voor handmatige journaalposten (placeholder)
- âœ… **Zoeken & Filteren** - Op omschrijving, referentie, datum
- âœ… **Export functionaliteit** - Exporteer journaal naar CSV (placeholder)

---

## Permissions Systeem

- âœ… **Admin/Boekhouder** - Volledige toegang (grootboek, facturen, BTW, journaal, dossiers)
- âœ… **Verkoper/Inkoop** - Alleen dossiers tab (klant- en leveranciersdossiers)
- âœ… **Monteur** - Geen toegang

---

## Integratie met Bestaande Modules

- âœ… **POS / Kassa** â†’ Automatische factuur + journaalpost + kassa verkopen tab
- âœ… **Pakbon (B2B)** â†’ Wordt factuur bij "Markeer als gefactureerd"
- âœ… **Voorraad** â†’ Inkoopfactuur â†’ voorraad + crediteuren
- âœ… **CRM** â†’ Klantgegevens automatisch in dossier
- âœ… **Accounting Module** â†’ Facturen automatisch in archief
- ğŸ†• **Kassa Verkopen** â†’ Direct zichtbaar in aparte tab met betaalmethode

---

## Voordelen

- âœ… **MKB-Ready** - Standaard MKB grootboekset ingebouwd
- âœ… **NL-Compliant** - BTW per tarief (21%, 9%, 0%) gesplitst
- âœ… **Aangifte-Ready** - BTW-rapport klaar voor accountant/belastingdienst
- âœ… **Geen handmatig werk** - Automatisch journaal en BTW-berekening
- âœ… **Volledig digitaal** - Alle facturen en dossiers op Ã©Ã©n plek
- âœ… **Traceerbaar** - Elke transactie gekoppeld aan bron
- âœ… **Controle-ready** - Direct klaar voor Belastingdienst controle

---

## Toekomstige Uitbreidingen

- ğŸ”„ XML export voor BTW-aangifte (Belastingdienst portaal)
- ğŸ”„ PDF generatie voor facturen
- ğŸ”„ Herinneringen systeem voor openstaande facturen
- ğŸ”„ Inkoopfacturen integratie
- ğŸ”„ Voorbelasting berekening vanuit inkoopfacturen
- ğŸ”„ Volledige dossiers met tabbladen functionaliteit
- ğŸ”„ Handmatige journaalposten toevoegen UI

---

## Gerelateerde Modules

- [Werkorders](./workorders.md) - Voor werkorder conversie
- [Voorraadbeheer](./inventory.md) - Voor voorraad items
- [CRM](./crm.md) - Voor klantbeheer
- [POS](./pos.md) - Voor kassa verkopen

## Versie Geschiedenis

- **V5.8** - Email integratie voor offerte creatie vanuit emails
- **V5.6** - Automatische kloon bij acceptatie, herinneringsplanning, betaalde facturen verbergen
- **V5.4** - Kassa verkopen tab, klikbare facturen, clone functionaliteit
- **V4.7** - Overzicht modals met filtering en acties
- **V4.6** - Clone functie voor offertes
- **V4.0** - Werkorder integratie, bidirectionele synchronisatie

# CRM (Klantrelatiebeheer)

ğŸ†• **VOLLEDIG VERNIEUWD + EMAIL INTEGRATIE V5.8**

## Overzicht

Professioneel CRM systeem met leads tracking, 7-fase pipeline, klantbeheer, interacties en email integratie.

## Functionaliteiten

### Dashboard Tab

#### KPI Cards & Statistieken

- âœ… **KPI Cards** - Real-time statistieken en conversie rates
- âœ… **Leads tracking** (totaal/actief/gewonnen/verloren)
- âœ… **Conversie percentage** (lead naar klant)
- âœ… **Pipeline waarde** overzicht
- âœ… **Klanten statistieken** (zakelijk/particulier)
- âœ… **Activiteiten overzicht** (interacties/follow-ups/taken)

#### Timeline & Waarschuwingen

- âœ… **Recente activiteiten timeline**
- âœ… **Verlopen taken waarschuwingen**

---

### Leads & Pipeline Tab

#### Lead Management

- âœ… **Lead management** - Volledige lead tracking
- âœ… **7-fase Pipeline** - Kanban-stijl board:
  1. Nieuw
  2. Contact
  3. Gekwalificeerd
  4. Voorstel
  5. Onderhandeling
  6. Gewonnen
  7. Verloren

#### Lead Informatie

- âœ… **Lead informatie** (naam, email, telefoon, bedrijf)
- âœ… **Herkomst tracking** (website, referral, cold-call, advertisement, etc.)
- âœ… **Geschatte waarde** per lead
- âœ… **Follow-up datums**

#### Status & Conversie

- âœ… **Status flow** met knoppen voor voortgang
- âœ… **Lead conversie** - Converteer gewonnen leads naar klanten
- âœ… **Pipeline waarde** per fase
- âœ… **Drag & drop** tussen fasen (visueel)

---

### Klanten Tab

#### Basis Klantbeheer

- âœ… **Klantgegevens beheer** (naam, email, telefoon, adres)
- âœ… **Klanttypes: zakelijk en particulier**
- âœ… **Herkomst tracking** - Weet waar klanten vandaan komen
- âœ… **Bedrijfsnaam** (voor zakelijke klanten)
- âœ… **Klant sinds datum**

#### Historie & Statistieken

- âœ… **Verkoop historie** per klant
- âœ… **Interactie geschiedenis** - Aantal contactmomenten
- âœ… **Totaal besteed bedrag**
- âœ… **Aantal orders** per klant

#### Klant Details & Beheer

- âœ… **Visuele klant cards** met avatar
- âœ… **Notities per klant** - Voeg interne notities toe voor klanthistorie ğŸ†•
- âœ… **Klanten bewerken** - Wijzig klantgegevens en notities ğŸ†•
- âœ… **Add/Edit/Delete functionaliteit** ğŸ†•

#### Facturen in Klantoverzicht

- ğŸ†• **Facturen in klantoverzicht** - Klik op klant â†’ FinanciÃ«n â†’ Zie alleen betaalde en openstaande facturen
- ğŸ†• **Factuur acties** - Bij elke factuur in klantoverzicht:
  - âœï¸ **Bewerken** - Open factuur in edit modal
  - ğŸ“‹ **Clonen** - Maak kopie van factuur met nieuw nummer
  - ğŸ“¤ **Naar Werkorder** - Converteer factuur naar werkorder (met user selectie)
- ğŸ†• **Clone & Edit modals** - Volledig bewerkbare formulieren met items/labor beheer
- ğŸ†• **Werkorder conversie** - Factuur naar werkorder met specifieke user toewijzing

---

### Interacties Tab

#### Communicatie Geschiedenis

- âœ… **Communicatie geschiedenis** - Alle contactmomenten vastleggen
- âœ… **5 Interactie types**:
  - ğŸ“ Call (Telefoon)
  - ğŸ“§ Email
  - ğŸ¤ Meeting (Vergadering)
  - ğŸ“ Note (Notitie)
  - ğŸ’¬ SMS

#### Interactie Details

- âœ… **Koppeling aan leads of klanten**
- âœ… **Subject en beschrijving**
- âœ… **Datum en tijd tracking**
- âœ… **Medewerker** die contact heeft gehad

#### Follow-up Systeem

- âœ… **Follow-up systeem** - Automatische herinneringen
- âœ… **Follow-up datum tracking**
- âœ… **Timeline weergave** (chronologisch)
- âœ… **Visuele iconen** per interactie type

---

### Email Tab

ğŸ†• **NIEUW IN V5.8**

- ğŸ†• **Email Drop Zone** - Sleep .eml bestanden of Outlook emails naar CRM module
- ğŸ†• **Universele email preview** - Preview modal voor alle email types
- ğŸ†• **Automatische interactie creatie** - Emails worden automatisch omgezet naar interactie records
- ğŸ†• **Klant/lead creatie** - Maak nieuwe klanten of leads aan vanuit email adres
- ğŸ†• **Taak creatie** - Converteer emails naar taken met deadline tracking
- ğŸ†• **Email-customer mapping** - Sla email adres naar klant mapping op voor toekomstige matching
- ğŸ†• **Workflow detectie** - Systeem detecteert automatisch of email een order, taak of notificatie is

---

### Taken Tab

#### Taken Beheer

- âœ… **Taken/follow-ups** per klant
- âœ… **Prioriteit levels** (laag/gemiddeld/hoog)
- âœ… **Status tracking** (todo/in_progress/done)
- âœ… **Deadline management** met verlopen waarschuwing
- âœ… **Klant koppeling** (optioneel)

#### Visuele Feedback

- âœ… **Visuele status indicators**
- âœ… **Add/Delete/Update functionaliteit**

---

## Gebruik

### Lead Management Workflow

1. **Nieuwe lead toevoegen**
   - Vul naam, email, telefoon, bedrijf in
   - Selecteer herkomst (website, referral, etc.)
   - Geef geschatte waarde op
   - Lead start in "Nieuw" fase

2. **Lead door pipeline verplaatsen**
   - Gebruik status knoppen of drag & drop
   - Voeg notities toe bij elke fase verandering
   - Stel follow-up datums in

3. **Lead converteren naar klant**
   - Bij "Gewonnen" status
   - Klik "Converteer naar Klant"
   - Lead wordt automatisch klant in systeem

### Klant Beheer

1. **Klant bekijken**
   - Klik op klant card
   - Zie volledige historie
   - Bekijk facturen en interacties

2. **Notities toevoegen**
   - Open klant detail
   - Voeg interne notities toe
   - Bijvoorbeeld: "Betaalt altijd op tijd", "Prefers email contact"

3. **Facturen beheren**
   - Ga naar FinanciÃ«n tab in klant detail
   - Zie alle facturen
   - Bewerk, kloon of converteer naar werkorder

### Interacties Bijhouden

1. **Interactie registreren**
   - Selecteer type (Call, Email, Meeting, etc.)
   - Koppel aan klant of lead
   - Vul subject en beschrijving in
   - Stel eventueel follow-up datum in

2. **Follow-up herinneringen**
   - Systeem waarschuwt bij vervallen follow-ups
   - Zie verlopen taken in dashboard

### Email Verwerking (V5.8)

1. **Email slepen**
   - Sleep .eml bestand naar Email tab
   - Of gebruik Outlook integratie (Electron app)

2. **Preview & verificatie**
   - Bekijk email in preview modal
   - Controleer automatische detectie

3. **Actie kiezen**
   - CreÃ«er interactie record
   - Maak nieuwe klant/lead
   - Converteer naar taak
   - Of annuleer

---

## Integraties

### Accounting Module

- Facturen automatisch zichtbaar in klant detail
- Clone functionaliteit voor herhalende facturen
- Werkorder conversie vanuit facturen

### Werkorders Module

- Facturen converteren naar werkorders
- Medewerker toewijzing bij conversie
- Status tracking van werkorders

### Email Systeem

- Automatische interactie creatie vanuit emails
- Email-customer mapping voor toekomstige herkenning
- Workflow detectie voor automatische routing

---

## ğŸ› Troubleshooting

### Probleem: Klanten worden niet opgeslagen

**Symptomen:**
- Knop "Opslaan" reageert niet
- Klant formulier geeft errors
- Klant verdwijnt na refresh

**Oorzaak:**
- Verplichte veld niet ingevuld (naam, email)
- Email formaat is incorrect
- Geen admin rechten
- Database validatie fout

**Oplossing:**
1. Zorg dat alle verplichte velden ingevuld zijn
2. Controleer email formaat (xxx@domein.nl)
3. Ververs de pagina (F5)
4. Check huidige rol in profiel - Admin rechten nodig
5. Check browser console (F12) voor details

---

### Probleem: Dubbele klanten

**Symptomen:**
- Dezelfde klant verschijnt meerdere keren
- Duplicaten in klantlijst
- Facturen verdeeld over duplicaten

**Oorzaak:**
- Klant aangemaakt met iets ander gespeld naam
- Email adres is iets ander (spatie, hoofdletter)
- Conversie van leads maakte duplicate
- Import van oude data

**Oplossing:**
1. Check klantlijst op vergelijkbare namen
2. Merge duplicaten handmatig (verwijder duplicate, update referenties)
3. Zorg voor consistent naamgeving
4. Check email spelling exact
5. Voer data cleanup uit

---

### Probleem: Email adressen verkeerd formaat

**Symptomen:**
- Email integratie werkt niet
- Emails kunnen niet naar klant gesleept worden
- Email validation faalt

**Oorzaak:**
- Email is niet valide (geen @)
- Spaties in email adres
- Speciale karakters
- Typo in email adres

**Oplossing:**
1. Check email format: naam@domein.nl (geen spaties)
2. Corrigeer typo's
3. Verwijder spaties en speciale karakters
4. Update klant met correct email
5. Test email integratie opnieuw

---

### Veelvoorkomende Errors

#### Error: "Invalid email format"
**Oorzaak:** Email is niet correct formaat
**Oplossing:** Zorg voor standaard email (xxx@domein.nl)

#### Error: "Customer already exists"
**Oorzaak:** Klant is al in systeem
**Oplossing:** Controleer klantlijst op duplicate, merge indien nodig

#### Error: "Permission denied"
**Oorzaak:** Gebruiker heeft geen edit rechten
**Oplossing:** Vraag admin voor editor rechten

---

### Pipeline Issues

**Symptomen:** Leads kunnen niet verplaatst worden, status update faalt
**Mogelijke oorzaken:**
- Lead is vergrendeld
- Database sync fout
- Status workflow is verkeerd
**Oplossingen:**
1. Check lead status
2. Volg correct pipeline flow (Nieuw â†’ Gewonnen/Verloren)
3. Ververs pagina

---

### Follow-up Herinnering Issues

**Symptomen:** Herinneringen worden niet getoond, vervallen taken warning verdwijnt
**Mogelijke oorzaken:**
- Notificaties module is uit
- Datum is incorrect ingesteld
- Browser notifications disabled
**Oplossingen:**
1. Check Notificaties module is aan
2. Controleer follow-up datum
3. Allow browser notifications

---

### Email Import Issues

**Symptomen:** Emails kunnen niet naar CRM gesleept worden
**Mogelijke oorzaken:**
- Email module niet enabled
- Bestandstype is niet .eml
- Email parsing failed
**Oplossingen:**
1. Check Modules â†’ Email support enabled
2. Zorg voor .eml bestanden
3. Check email content is valide

---

### Tips voor Debugging

1. **Open Browser Console** (F12) om errors te zien
2. **Check Network Tab** voor API errors
3. **Refresh de pagina** (F5) bij rare gedrag
4. **Controleer email geldigheid** voor integratie issues
5. **Test in Incognito Mode** om extensies uit te sluiten

## Gerelateerde Modules

- [Accounting](./accounting.md) - Voor facturatie en betalingen
- [Werkorders](./workorders.md) - Voor werkorder conversie
- [Dashboard](./dashboard.md) - Voor email integratie
- [Notificaties](./notifications.md) - Voor herinneringen

---

## Versie Geschiedenis

- **V5.8** - Email integratie met drag-and-drop en automatische workflow detectie
- **V5.0** - Facturen in klantoverzicht, clone & edit functionaliteit
- **V4.5** - Klant notities systeem, edit functionaliteit
- **V4.0** - Volledige CRM vernieuwing met 7-fase pipeline
